---
title: "p8105_hw2_ac4964"
author: "AnMei Chen"
date: "10/1/2021"
output: github_document
---

```{r}
library(tidyverse)
library(readxl)
library(dplyr)
library(ggplot2)

```

# Problem 1

Read and clean the Mr.Trash Wheel sheet

```{r}
Mr_trash_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",sheet = "Mr. Trash Wheel", range = "A2:N406") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(
    sports_balls = round(sports_balls,digits = 0)
  )

```


Read and clean precipitation data for 2018 and 2019

```{r}
Precipitation_2018_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",sheet = "2018 Precipitation", range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  mutate(year = "2018") %>% 
  relocate(year)

Precipitation_2019_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",sheet = "2019 Precipitation", range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  mutate(year = "2019") %>% 
  relocate(year)
```


Combine 2018 and 2019 precipitation datasets

```{r}
Precipitations_df = 
  bind_rows(Precipitation_2018_df,Precipitation_2019_df) %>% 
  mutate( month = month.name[month])
```


Write a paragraph about the Mr.Trash Wheel dataset:

The dataset of Mr.Trash Wheel (Mr.Trash_df) contains data of the trashes collected by Mr. Trash Wheel from `r min(Mr_trash_df$year)` to `r max(Mr_trash_df$year)`. It contains a total of `r nrow(Mr_trash_df)` observations and `r ncol(Mr_trash_df)` variables (`r colnames(Mr_trash_df)`). It has collected a total of `r sum(Mr_trash_df$weight_tons)` tons and `r sum(Mr_trash_df$volume_cubic_yards)` cubic yards of trashes. The median number of sports balls in a dumpster in 2017 is `r median(pull(filter(Mr_trash_df, year == 2017),sports_balls))`.

```{r}
# To find the median number of sports balls in a dumpster in 2017

get_2017_df = filter(Mr_trash_df, year == 2017)
pull_sports_balls = pull(get_2017_df,sports_balls)
median(pull_sports_balls)
```

Write a paragraph for the combined precipitation data set:

The dataset of 2018 and 2019 precipitation contains data of the precipitations collected from `r min(Precipitations_df$year)` to `r max(Precipitations_df$year)`, with the maximum precipitation of `r max(Precipitations_df$total, na.rm = TRUE)` and minimum precipitation of `r min(Precipitations_df$total,na.rm = TRUE)`. It contains a total of `r nrow(Precipitations_df)` observations and `r ncol(Precipitations_df)` variables (`r colnames(Precipitations_df)`). The total precipitation in 2018 is `r sum(pull(Precipitations_df,total),na.rm = TRUE)`.



# Problem 2

Read and clean the data in pols-month.csv

```{r}
pols_month_df = 
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(mon, into = c("year", "month","day"), sep = "-",convert = TRUE) %>% 
  mutate( 
    month = month.name[month],
    #create a president variable taking values gop and dem
    #president = c("gop","dem")
    ) %>% 
  select(c(-prez_gop,-prez_dem,-day))
```

read and clean data in snp.csv

```{r}
snp_df = 
  read.csv("data/fivethirtyeight_datasets/snp.csv") %>% 
  janitor::clean_names() %>% 
  separate(date, into = c("month", "day","year"), sep = "/",convert = TRUE) %>% 
  mutate( 
    month = month.name[month],
    ) %>% 
  arrange(year, month) %>% 
  relocate(year)  

```

Read and clean the unemployment data

```{r}
unemploy_df = 
  read.csv("data/fivethirtyeight_datasets/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment") 


```


Merge snp into pols

```{r}
snp_pols_df =
  full_join(pols_month_df, snp_df,by = c("year","month")) 



```

Write a paragraph about these datasets



# Problem 3

Read and load Popular baby names data

```{r}
baby_names_df =
  read_csv("./data/Popular_Baby_Names.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    gender = str_to_title(gender),
    ethnicity = str_to_title(ethnicity),
    childs_first_name = str_to_title(childs_first_name),
    ethnicity = replace(ethnicity, ethnicity == "Asian And Paci", "Asian And Pacific Islander"),
    ethnicity = replace(ethnicity, ethnicity == "Black Non Hisp", "Black Non Hispanic "),
    ethnicity = replace(ethnicity, ethnicity == "White Non Hisp", "White Non Hispanic ")
    ) %>% 
  distinct()
```

Produce a reader-friendly table showing the rank in the popularity of the name "Olivia" as a female baby name over time.

```{r}
Olivia_rank_df = filter(baby_names_df, childs_first_name == "Olivia")

Olivia_rank = 
  Olivia_rank_df %>% 
  pivot_wider(
    names_from = "year_of_birth",
    values_from = "rank"
  ) %>% 
  select(c(-gender,-count,-childs_first_name)) %>% 
  arrange(ethnicity) %>% 
  knitr::kable() 

```


Produce a table showinh the most popular name among male children over time

```{r}
male_rank_df = filter(baby_names_df, gender == "Male")


male_rank = 
  male_rank_df %>% 
  pivot_wider(
    names_from = "year_of_birth",
    values_from = "rank"
  ) %>% 
  arrange(ethnicity) %>% 
  knitr::kable() 


```



Produce a scatter plot for male, white non-Hispanic children born in 2016.

```{r}

wnh_male_rank_df = filter(baby_names_df, gender == "Male", ethnicity == "White Non Hispanic", year_of_birth == "2016") 

wnh_male_rank_plot <- ggplot(wnh_male_rank_df, aes( x = rank , y = childs_first_name)) + geom_point(size = 0.5)

wnh_male_rank_plot + theme(axis.text = element_text(size = 0.05),
        axis.title = element_text(size = 2,face = "bold"))
wnh_male_rank_plot

```


